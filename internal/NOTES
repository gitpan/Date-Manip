The files in this directory are for primary use by me, the author
of Date::Manip to prepare a new release.

There is no reason for an end user to need to do this. However, it
is documented for the sake of completeness, and to remind me of the
steps I need to do.

It's also available in case someone ever chooses to fork the
module (though I hope that won't be necessary).

#########################################################################
Update the windows zones.  Useful information in determining timezone
mapping may be obtained by searching for 'Time Zone Index Values' at:

   http://support.microsoft.com/
   http://support.microsoft.com/kb/973627

Go to:
   http://unicode.org/repos/cldr-tmp/trunk/diff/supplemental/zone_tzid.html
and copy the contents of the 'Mapping for: windows' table into a file 'windows.new'
and run the script:
   windows.compare

Currently, ignore the suggestions:
   "Argentina Standard Time"         => "America/Buenos_Aires",
   "India Standard Time"             => "Asia/Calcutta",
   "Nepal Standard Time"             => "Asia/Katmandu",
   "US Eastern Standard Time"        => "America/Indianapolis",

Make sure that new and changed zones refer to valid Olsen time zones. Make
the changes in data.alias.pl .

Then remove windows.new .

#########################################################################
Get the newest tzdata package.

The tzdata/tzcode archives are obtained from

   ftp://elsie.nci.nih.gov/pub/

In order to create the appropriate Date::Manip modules, run the
following commands:

   ./internal/tzdata -f           : to download the packages
   ./internal/tzdata -b           : to build the package
   ./internal/tzdata -l           : to get a list of all the zones that need modules
   ./internal/tzdata -d           : to dump all zones
   ./internal/tzdata -m           : to create the individual zone modules
   ./internal/tzdata -o           : to create the individual offset modules
                                    *** see NOTE 2 below ***
   ./internal/tzdata -z           : to create the main Zone module
                                    *** see NOTE 2 below ***

Before cleaning up the tzdata directory, run the following to double
check every timezone in zoneinfo against the Date::Manip version:

   make install
   ./internal/dumps

Run the two tzdata tests:

   (cd t; ./runtests tzdata)

Then clean up:

   ./internal/tzdata -c

NOTE: although the tzdata script runs on my computer, it is quite possible
that it will not run on other systems due to differences in what tools are
available.

Since the tzdata script is designed only to create the modules which are
then distributed as part of Date::Manip, there is no reason for anyone other
than me to run the above commands. If you DO choose to run them, please do
not report problems due to differences in operating systems, or packages that
are installed on your system. If you discover a bug in tzdata, I am interested
in knowing about it however.

NOTE 2: These steps often require manual intervention described
below. After the intervention, rerun the command to make sure no
output is produced.

The old values of data are stored in the internal/data.* files. This is
so that I am explicitly notified of every change to the zoneinfo data
which could impact Date::Manip.  Any output reflects potential changes
so every entry should be checked to ensure that it acceptable. Then,
the output needs to be added to the appropriate data.* file, replacing
any previous value for the entry.  It is especially important that the first
line in each entry should remain unchanged unless there is good reason
to change it. The order of remaining lines may change to some extent.

If the '-o' option produces any output, the entries need to be added
to the data.offset.pl file.

If the '-z' option produces any output, the entries need to be added
to the data.alias.pl or data.abbrev.pl file.

#########################################################################
Clean up stuff that shouldn't be in the manifest

In internal/benchmarks directory
    rm -f nytprof.out parse-1.in
    rm -rf nytprof

#########################################################################
Set the release version

   # DM6

   v=`cat internal/VERSION | tail -1`
   for i in \
       internal/tzdata \
       internal/gen_dm5abbrevs \
       `find lib -name \*.pm` \
   ;do
      sed -e "s,VERSION='.*',VERSION='$v'," $i > z
      mv z $i
   done
   chmod +x internal/tzdata internal/gen_dm5abbrevs

   # DM5

   v=`cat internal/VERSION | head -1`
   for i in \
       lib/Date/Manip/DM5.pm \
   ;do
      sed -e "s,VERSION='.*',VERSION='$v'," $i > z
      mv z $i
   done

#########################################################################
Before every release, spellcheck the documents:

   for i in `find lib -type f -name \*.pod` ;do
      podspell $i > $i.txt
      ispell -p internal/manip.isp $i.txt
      rm -f $i.txt $i.txt.bak
   done

#########################################################################
Update the copyright

   y=`date '+%Y'`
   for i in `find . -type f | egrep -v '.svn' | xargs egrep -l 'Copyright \(c\) ....\-.... Sullivan Beck'` ;do
     sed -e "s,\(Copyright (c) ....\)\-.... \(Sullivan Beck\),\1-$y \2," $i > z
     mv z $i
   done
   chmod +x internal/tzdata internal/gen_dm5abbrevs

#########################################################################
Switch the system timezone to America/Central and run the tests.

#########################################################################
Update the Changes5/Changes6 docs with the date. Then update internal/VERSION
to include the new version.

#########################################################################
Install the module. Then run the following:

   ./internal/gen_dm5abbrevs > lib/Date/Manip/DM5abbrevs.pm

#########################################################################
Regenerate the MANIFEST and run the kwalitee tests

#########################################################################
Run the internal/leak.pl whenever a new version of perl is available to
see if the leak persists. When it's fixed, note this in the known problems
section.

